<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>diagrams.net</title>
<meta http-equiv="refresh" content="0;URL='https://app.diagrams.net/#Hdacchen123%2Fnotes-for-diagrams%2Fmain%2Fnotes_for_Java_Concurrency_in_Practice%2F3%E3%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%B1%E4%BA%AB.drawio.html'"/>
<meta charset="utf-8"/>
</head>
<body>
<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;xml&quot;:&quot;&lt;mxfile host=\&quot;app.diagrams.net\&quot; modified=\&quot;2023-03-03T03:37:47.401Z\&quot; agent=\&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\&quot; etag=\&quot;Y6sgjSG1d-WIYYwLoS3v\&quot; version=\&quot;20.5.3\&quot; type=\&quot;github\&quot;&gt;&lt;diagram id=\&quot;ho83wQugu1sqS-715PNT\&quot; name=\&quot;第 1 页\&quot;&gt;&lt;mxGraphModel dx=\&quot;1422\&quot; dy=\&quot;1931\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;827\&quot; pageHeight=\&quot;1169\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;&gt;&lt;root&gt;&lt;mxCell id=\&quot;0\&quot;/&gt;&lt;mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot;/&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-1\&quot; value=\&quot;&amp;lt;h1&amp;gt;3、对象的共享&amp;lt;/h1&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;230\&quot; y=\&quot;70\&quot; width=\&quot;380\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-2\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-4\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;270\&quot; y=\&quot;130\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;281\&quot; y=\&quot;260\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-3\&quot; value=\&quot;内容\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-2\&quot;&gt;&lt;mxGeometry x=\&quot;-0.3543\&quot; y=\&quot;-1\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint y=\&quot;16\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-4\&quot; value=\&quot;如何共享和发布对象，使它们能安全被多个线程同时访问\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;190\&quot; y=\&quot;260\&quot; width=\&quot;160\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-5\&quot; value=\&quot;\&quot; style=\&quot;endArrow=none;html=1;rounded=0;exitX=0.6;exitY=1.05;exitDx=0;exitDy=0;exitPerimeter=0;endFill=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-1\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;460\&quot; y=\&quot;250\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;459\&quot; y=\&quot;340\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-26\&quot; value=\&quot;同步的特性\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-5\&quot;&gt;&lt;mxGeometry x=\&quot;0.5577\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-7\&quot; value=\&quot;\&quot; style=\&quot;shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;rotation=-90;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;450\&quot; y=\&quot;290\&quot; width=\&quot;20\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-8\&quot; value=\&quot;原子性\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;370\&quot; y=\&quot;360\&quot; width=\&quot;58\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-9\&quot; value=\&quot;可见性\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;490\&quot; y=\&quot;360\&quot; width=\&quot;58\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-10\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-9\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;550\&quot; y=\&quot;520\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;520\&quot; y=\&quot;480\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-12\&quot; value=\&quot;同步机制\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-10\&quot;&gt;&lt;mxGeometry x=\&quot;-0.4991\&quot; y=\&quot;3\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;-3\&quot; y=\&quot;20\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-11\&quot; value=\&quot;确保多个线程间对内存写入操作的可见性\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;440\&quot; y=\&quot;480\&quot; width=\&quot;180\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-13\&quot; value=\&quot;编译器、处理器以及运行时都有可能对操作的执行顺序进行一些意想不到的调整\&quot; style=\&quot;shape=note2;boundedLbl=1;whiteSpace=wrap;html=1;size=25;verticalAlign=top;align=center;fillColor=#FFD966;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;570\&quot; y=\&quot;400\&quot; width=\&quot;250\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-14\&quot; value=\&quot;\&quot; style=\&quot;shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;rotation=90;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;478\&quot; y=\&quot;410\&quot; width=\&quot;20\&quot; height=\&quot;260\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-15\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=0.1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-14\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;510\&quot; y=\&quot;640\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;488\&quot; y=\&quot;630\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-16\&quot; value=\&quot;缺乏同步时\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-15\&quot;&gt;&lt;mxGeometry x=\&quot;-0.2927\&quot; y=\&quot;-2\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-17\&quot; value=\&quot;可能读到失效数据\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;428\&quot; y=\&quot;630\&quot; width=\&quot;120\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-18\&quot; value=\&quot;\&quot; style=\&quot;endArrow=none;html=1;rounded=0;endFill=0;entryX=0.1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-27\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-20\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;990\&quot; y=\&quot;170\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;984\&quot; y=\&quot;270\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-19\&quot; value=\&quot;含义\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-18\&quot;&gt;&lt;mxGeometry x=\&quot;-0.3725\&quot; y=\&quot;2\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;19\&quot; y=\&quot;9\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-20\&quot; value=\&quot;\&quot; style=\&quot;shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;rotation=-180;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;670\&quot; y=\&quot;110\&quot; width=\&quot;20\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-22\&quot; value=\&quot;互斥\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;692\&quot; y=\&quot;90\&quot; width=\&quot;58\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-23\&quot; value=\&quot;可见性\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;690\&quot; y=\&quot;210\&quot; width=\&quot;58\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-25\&quot; value=\&quot;同步\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;431\&quot; y=\&quot;210\&quot; width=\&quot;58\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-27\&quot; value=\&quot;加锁\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;512\&quot; y=\&quot;150\&quot; width=\&quot;58\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-29\&quot; value=\&quot;\&quot; style=\&quot;shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;490\&quot; y=\&quot;170\&quot; width=\&quot;20\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-30\&quot; value=\&quot;&amp;lt;b&amp;gt;volatile变量&amp;lt;/b&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;512\&quot; y=\&quot;270\&quot; width=\&quot;68\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-31\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-30\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-32\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;670\&quot; y=\&quot;320\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;720\&quot; y=\&quot;290\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-33\&quot; value=\&quot;不加锁，开销&amp;lt;br&amp;gt;只比普通变量略高\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-31\&quot;&gt;&lt;mxGeometry x=\&quot;-0.2857\&quot; y=\&quot;3\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;20\&quot; y=\&quot;3\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-32\&quot; value=\&quot;不会被缓存在寄存器或其他处理器不可见的地方\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;740\&quot; y=\&quot;270\&quot; width=\&quot;140\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-34\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-30\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-35\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;640\&quot; y=\&quot;370\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;700\&quot; y=\&quot;340\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-36\&quot; value=\&quot;只能确保\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-34\&quot;&gt;&lt;mxGeometry x=\&quot;0.299\&quot; y=\&quot;-3\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;-12\&quot; y=\&quot;-3\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-35\&quot; value=\&quot;可见性\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;710\&quot; y=\&quot;320\&quot; width=\&quot;58\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-37\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-38\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;520\&quot; y=\&quot;70\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;570\&quot; y=\&quot;20\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;Array as=\&quot;points\&quot;&gt;&lt;mxPoint x=\&quot;520\&quot;/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-38\&quot; value=\&quot;发布与逸出\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;580\&quot; y=\&quot;-20\&quot; width=\&quot;58\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-39\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-38\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-40\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;600\&quot; y=\&quot;-30\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;670\&quot; y=\&quot;-150\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-41\&quot; value=\&quot;发布对象\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-39\&quot;&gt;&lt;mxGeometry x=\&quot;-0.1045\&quot; y=\&quot;-2\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;-1\&quot; y=\&quot;40\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-44\&quot; value=\&quot;最简单方法\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-39\&quot;&gt;&lt;mxGeometry x=\&quot;0.5423\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-40\&quot; value=\&quot;将对象引用保存到一个公有的静态变量中\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;710\&quot; y=\&quot;-170\&quot; width=\&quot;130\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-42\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;610\&quot; y=\&quot;-110\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;860\&quot; y=\&quot;-110\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-45\&quot; value=\&quot;从对象的构造函数中发布对象\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;860\&quot; y=\&quot;-130\&quot; width=\&quot;120\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-46\&quot; value=\&quot;this引用在构造函数中逸出\&quot; style=\&quot;shape=note2;boundedLbl=1;whiteSpace=wrap;html=1;size=25;verticalAlign=top;align=center;fillColor=#FFD966;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1000\&quot; y=\&quot;-140\&quot; width=\&quot;170\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-49\&quot; value=\&quot;只是发布了一个尚未构造完成的对象\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;860\&quot; y=\&quot;-10\&quot; width=\&quot;120\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-50\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-45\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-49\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;920\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;970\&quot; y=\&quot;-50\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-51\&quot; value=\&quot;\&quot; style=\&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn2.iconfinder.com/data/icons/onebit/PNG/onebit_33.png\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1180\&quot; y=\&quot;-139\&quot; width=\&quot;48\&quot; height=\&quot;48\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-52\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-51\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1240\&quot; y=\&quot;-90\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;1320\&quot; y=\&quot;-115\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-53\&quot; value=\&quot;不正确构造\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1320\&quot; y=\&quot;-130\&quot; width=\&quot;70\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-55\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-46\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-57\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1120\&quot; y=\&quot;10\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;1085\&quot; y=\&quot;30\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-56\&quot; value=\&quot;常见错误\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-55\&quot;&gt;&lt;mxGeometry x=\&quot;-0.5333\&quot; y=\&quot;-1\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1\&quot; y=\&quot;22\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-57\&quot; value=\&quot;在构造函数中启动一个线程\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1032.5\&quot; y=\&quot;10\&quot; width=\&quot;105\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-59\&quot; value=\&quot;this引用都会被先创建的线程共享。在对象未完全构造之前，新的线程就能看见它\&quot; style=\&quot;shape=note2;boundedLbl=1;whiteSpace=wrap;html=1;size=25;verticalAlign=top;align=center;fillColor=#FFD966;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1241\&quot; width=\&quot;230\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-60\&quot; value=\&quot;\&quot; style=\&quot;endArrow=none;dashed=1;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-57\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-59\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1170\&quot; y=\&quot;50\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;1220\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-61\&quot; value=\&quot;在构造函数中创建线程没有错，但不要立即启动线程，而是通过start或initialize方法启动\&quot; style=\&quot;shape=note2;boundedLbl=1;whiteSpace=wrap;html=1;size=25;verticalAlign=top;align=center;fillColor=#FFD966;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1241\&quot; y=\&quot;90\&quot; width=\&quot;250\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-62\&quot; value=\&quot;\&quot; style=\&quot;endArrow=none;dashed=1;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;edgeStyle=orthogonalEdgeStyle;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-61\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1190\&quot; y=\&quot;30\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;1210\&quot; y=\&quot;70\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-63\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-57\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1090\&quot; y=\&quot;220\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;1085\&quot; y=\&quot;220\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-64\&quot; value=\&quot;解决办法\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-63\&quot;&gt;&lt;mxGeometry x=\&quot;-0.2\&quot; y=\&quot;-1\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-65\&quot; value=\&quot;使用一个私有的构造函数和一个公共的工厂方法\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;sketch=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1033\&quot; y=\&quot;220\&quot; width=\&quot;137\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-66\&quot; value=\&quot;只有当构造函数返回时，this引用才应该从线程中逸出。构造函数可以将this引用保存到某个地方，只要其他线程不会在构造函数完成前使用它\&quot; style=\&quot;shape=note2;boundedLbl=1;whiteSpace=wrap;html=1;size=25;verticalAlign=top;align=center;fillColor=#FFD966;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1260\&quot; y=\&quot;200\&quot; width=\&quot;259\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-68\&quot; value=\&quot;\&quot; style=\&quot;endArrow=none;dashed=1;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42bI1qVwHOXWYOODevzj-65\&quot; target=\&quot;42bI1qVwHOXWYOODevzj-66\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1190\&quot; y=\&quot;250\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;1240\&quot; y=\&quot;240\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42bI1qVwHOXWYOODevzj-69\&quot; value=\&quot;技术说明\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot; parent=\&quot;42bI1qVwHOXWYOODevzj-68\&quot;&gt;&lt;mxGeometry x=\&quot;0.2857\&quot; y=\&quot;1\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;-8\&quot; y=\&quot;1\&quot; as=\&quot;offset\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;&lt;/diagram&gt;&lt;/mxfile&gt;&quot;,&quot;toolbar&quot;:&quot;pages zoom layers lightbox&quot;,&quot;page&quot;:0}"></div>
<a style="position:absolute;top:50%;left:50%;margin-top:-128px;margin-left:-64px;" href="https://app.diagrams.net/#Hdacchen123%2Fnotes-for-diagrams%2Fmain%2Fnotes_for_Java_Concurrency_in_Practice%2F3%E3%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%B1%E4%BA%AB.drawio.html" target="_blank"><img border="0" src="https://app.diagrams.net/images/drawlogo128.png"/></a>
</body>
</html>
